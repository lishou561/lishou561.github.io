<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>半图不假</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            overflow: hidden;
            background: #000;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: 'Arial Black', sans-serif;
            position: relative;
            cursor: pointer; /* 添加指针光标表示可点击 */
        }

        /* 时钟样式 - 深色版本以匹配黑色背景 */
        .clock-container {
            background-color: rgba(33,33,33,0.7);
            padding: 1.8rem;
            border-radius: 1rem;
            z-index: 100;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: opacity 1s ease;
            cursor: pointer; /* 时钟区域可点击 */
        }

        .nianyue {
            color: #fff;
            font-size: 1.2rem;
            font-weight: bold;
            letter-spacing: 1px;
            margin: 0;
            text-align: center;
        }

        .time-display {
            color: #fff;
            font-size: 3rem;
            font-weight: bold;
            letter-spacing: 3px;
            margin: 0;
            text-align: center;
        }

        /* 倒计时数字样式 - 发光阴影 */
        .countdown {
            font-size: 12rem;
            color: #fff;
            text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 40px #0ff, 0 0 80px #0ff, 0 0 120px #0ff;
            margin-bottom: 2rem;
            opacity: 1;
            transition: opacity 0.5s ease;
            z-index: 10;
            position: relative;
            pointer-events: none; /* 防止倒计时数字干扰点击事件 */
        }

        /* 新年快乐文字 - 彩色渐变边框 */
        .happy-new-year {
            font-size: 5rem;
            background: linear-gradient(90deg, #ff0000, #ff9900, #33ff00, #3300ff, #9900ff, #ff0099);
            background-size: 600% 100%;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            border: 4px solid;
            border-image: linear-gradient(90deg, #ff0000, #ff9900, #33ff00, #3300ff, #9900ff, #ff0099) 1;
            padding: 1rem 2rem;
            border-radius: 10px;
            animation: gradientMove 3s linear infinite;
            opacity: 0;
            transition: opacity 0.5s ease;
            z-index: 10;
            position: relative;
            pointer-events: none; /* 防止新年快乐文字干扰点击事件 */
        }

        @keyframes gradientMove {
            0% { background-position: 0% 50%; border-image-source: linear-gradient(90deg, #ff0000, #ff9900, #33ff00, #3300ff, #9900ff, #ff0099); }
            50% { background-position: 100% 50%; border-image-source: linear-gradient(90deg, #ff0099, #9900ff, #3300ff, #33ff00, #ff9900, #ff0000); }
            100% { background-position: 0% 50%; border-image-source: linear-gradient(90deg, #ff0000, #ff9900, #33ff00, #3300ff, #9900ff, #ff0099); }
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 0;
        }

        /* 隐藏元素 */
        .hidden {
            opacity: 0 !important;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <!-- 时钟容器 -->
    <div class="clock-container" id="clockContainer">
        <p id="nianyue" class="nianyue" aria-live="polite"></p>
        <p id="time" class="time-display" aria-live="polite"></p>
    </div>

    <!-- 倒计时和新年祝福 -->
    <div class="countdown hidden" id="countdown">10</div>
    <div class="happy-new-year" id="happyNewYear">2026 新年快乐</div>
    
    <!-- 烟花画布 -->
    <canvas id="fireworksCanvas"></canvas>

    <script>
        // 画布初始化
        const canvas = document.getElementById('fireworksCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // 获取DOM元素
        const clockContainer = document.getElementById('clockContainer');
        const countdownEl = document.getElementById('countdown');
        const happyNewYearEl = document.getElementById('happyNewYear');
        const nianyueEl = document.getElementById('nianyue');
        const timeEl = document.getElementById('time');
        
        // 设置目标时间为2026年1月1日00:00:00
        const targetTime = new Date(2026, 0, 1, 0, 0, 0).getTime();
        let countdownActive = false;
        let fireworksStarted = false;
        
        // 增强烟花循环控制
        let enhancedFireworksActive = false; // 控制增强放烟花的状态
        let enhancedFireworksInterval = null; // 发射烟花的定时器
        let enhancedFireworksTimeout = null; // 暂停的定时器
        
        // 当前烟花数量（用于渐进增加）
        let currentFireworkCount = 5;
        
        // 随机数生成函数
        function getRandomDuration(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // 实时时钟功能
        function updateClock() {
            const now = new Date();
            const time = {
                hours: now.getHours().toString().padStart(2, '0'),
                minutes: now.getMinutes().toString().padStart(2, '0'),
                seconds: now.getSeconds().toString().padStart(2, '0')
            };
            const date = {
                year: now.getFullYear(),
                month: now.getMonth() + 1,
                day: now.getDate()
            };
            
            timeEl.textContent = `${time.hours}:${time.minutes}:${time.seconds}`;
            nianyueEl.textContent = `${date.year}年${date.month}月${date.day}日`;
            
            // 检查是否到达2026年1月1日00:00:00
            const currentTime = now.getTime();
            if (currentTime >= targetTime && !fireworksStarted) {
                startNewYearCelebration();
            } else if (!countdownActive) {
                // 计算距离目标时间的剩余秒数
                const distance = targetTime - currentTime;
                const seconds = Math.floor(distance / 1000);
                
                // 如果距离目标时间10秒以内，开始倒计时显示
                if (seconds <= 10 && seconds > 0) {
                    startCountdown(seconds);
                }
            }
        }

        // 开始倒计时
        function startCountdown(initialSeconds) {
            countdownActive = true;
            countdownEl.classList.remove('hidden');
            countdownEl.textContent = initialSeconds;
            
            let countdownValue = initialSeconds;
            const countdownInterval = setInterval(() => {
                countdownValue--;
                countdownEl.textContent = countdownValue;
                
                if (countdownValue <= 0) {
                    clearInterval(countdownInterval);
                }
            }, 1000);
        }

        // 开始新年庆祝
        function startNewYearCelebration() {
            fireworksStarted = true;
            
            // 隐藏时钟
            clockContainer.classList.add('hidden');
            
            // 隐藏倒计时数字
            countdownEl.classList.add('hidden');
            
            // 显示新年快乐文字
            setTimeout(() => {
                happyNewYearEl.style.opacity = 1;
            }, 500);
            
            // 开始烟花效果
            launchFirework();
            setInterval(launchFirework, 500);
        }

        // 烟花粒子类
        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                // 调整粒子扩散速度，从原来的2-5调整为1.5-3.5
                this.speed = Math.random() * 2 + 1.5;
                this.angle = Math.random() * Math.PI * 2;
                this.gravity = 0.05;
                this.vx = Math.cos(this.angle) * this.speed;
                this.vy = Math.sin(this.angle) * this.speed;
                this.alpha = 1;
                // 稍微延长粒子消失时间
                this.decay = Math.random() * 0.008 + 0.004;
                this.color = color;
            }

            update() {
                // 重力影响：y方向速度增加
                this.vy += this.gravity;
                this.x += this.vx;
                this.y += this.vy;
                // 粒子逐渐消失
                this.alpha -= this.decay;
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.restore();
            }
        }

        // 炮筒上升类
        class Firework {
            constructor(x = null) {
                // 如果传入x坐标则使用，否则随机
                this.x = x !== null ? x : Math.random() * canvas.width;
                this.y = canvas.height;
                // 随机爆炸高度（画布1/3到2/3之间）
                this.targetY = Math.random() * canvas.height / 3 + canvas.height / 10;
                // 调整烟花上升速度，从原来的4-7调整为3-5.5
                this.speed = Math.random() * 2.5 + 3;
                this.color = `hsl(${Math.random() * 360}, 100%, 50%)`; // 随机鲜艳颜色
                this.isExploded = false;
            }

            update() {
                if (!this.isExploded) {
                    // 炮筒上升
                    this.y -= this.speed;
                    // 到达目标高度后爆炸
                    if (this.y <= this.targetY) {
                        this.isExploded = true;
                        // 生成爆炸粒子（50-100个）
                        const particleCount = Math.floor(Math.random() * 50 + 50);
                        for (let i = 0; i < particleCount; i++) {
                            particles.push(new Particle(this.x, this.y, this.color));
                        }
                    }
                }
            }

            draw() {
                if (!this.isExploded) {
                    // 绘制上升的炮筒（小线段）
                    ctx.save();
                    ctx.beginPath();
                    ctx.moveTo(this.x, this.y);
                    ctx.lineTo(this.x, this.y + 10);
                    ctx.strokeStyle = this.color;
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    ctx.restore();
                }
            }
        }

        let fireworks = [];
        let particles = [];

        // 发射烟花函数
        function launchFirework(x = null) {
            fireworks.push(new Firework(x));
        }

        // 发射增强烟花（渐进增加数量）
        function launchEnhancedFireworks() {
            // 每次发射当前数量的烟花
            for (let i = 0; i < currentFireworkCount; i++) {
                launchFirework();
            }
            
            // 渐进增加烟花数量，直到达到最大值（5-12个）
            if (currentFireworkCount < 12) {
                // 每3次发射增加1个烟花，使增加过程更平缓
                if (Math.random() < 0.33) { // 约1/3的概率增加
                    currentFireworkCount++;
                }
            }
        }

        // 开始增强烟花循环
        function startEnhancedFireworksCycle() {
            if (enhancedFireworksActive) {
                // 如果已经在运行，则停止
                stopEnhancedFireworks();
                return;
            }
            
            enhancedFireworksActive = true;
            // 重置烟花数量为起始值（5个）
            currentFireworkCount = 5;
            
            // 开始循环
            startFireworkPhase();
        }

        // 开始烟花阶段（放烟花3-4秒）
        function startFireworkPhase() {
            if (!enhancedFireworksActive) return;
            
            // 随机决定本次放烟花的持续时间（3-4秒）
            const fireworkDuration = getRandomDuration(3, 4) * 1000;
            
            // 开始发射烟花（每300毫秒发射一次）
            enhancedFireworksInterval = setInterval(launchEnhancedFireworks, 300);
            
            // 设置定时器，在放烟花持续时间结束后停止并进入暂停阶段
            enhancedFireworksTimeout = setTimeout(() => {
                clearInterval(enhancedFireworksInterval);
                enhancedFireworksInterval = null;
                
                // 进入暂停阶段
                startPausePhase();
            }, fireworkDuration);
        }

        // 开始暂停阶段（停顿1-2秒）
        function startPausePhase() {
            if (!enhancedFireworksActive) return;
            
            // 随机决定暂停时间（1-2秒）
            const pauseDuration = getRandomDuration(1, 2) * 1000;
            
            // 设置定时器，在暂停时间结束后重新开始烟花阶段
            enhancedFireworksTimeout = setTimeout(() => {
                startFireworkPhase();
            }, pauseDuration);
        }

        // 停止增强烟花
        function stopEnhancedFireworks() {
            enhancedFireworksActive = false;
            
            // 清除所有定时器
            if (enhancedFireworksInterval) {
                clearInterval(enhancedFireworksInterval);
                enhancedFireworksInterval = null;
            }
            
            if (enhancedFireworksTimeout) {
                clearTimeout(enhancedFireworksTimeout);
                enhancedFireworksTimeout = null;
            }
            
            // 重置烟花数量
            currentFireworkCount = 5;
        }

        // 动画循环
        function animate() {
            requestAnimationFrame(animate);
            // 半透明背景，实现拖影效果
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // 更新和绘制烟花炮筒
            for (let i = fireworks.length - 1; i >= 0; i--) {
                const fw = fireworks[i];
                fw.update();
                fw.draw();
                // 爆炸后移除炮筒
                if (fw.isExploded) {
                    fireworks.splice(i, 1);
                }
            }

            // 更新和绘制粒子
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.update();
                p.draw();
                // 粒子透明后移除
                if (p.alpha <= 0) {
                    particles.splice(i, 1);
                }
            }
        }

        // 初始化
        updateClock();
        setInterval(updateClock, 1000);
        animate();

        // 点击时钟区域触发增强烟花循环
        clockContainer.addEventListener('click', (e) => {
            e.stopPropagation(); // 阻止事件冒泡
            startEnhancedFireworksCycle();
        });

        // 点击其他区域触发单个烟花
        document.addEventListener('click', (e) => {
            // 排除时钟区域
            if (e.target.closest('.clock-container')) return;
            
            const fw = new Firework(e.clientX);
            fireworks.push(fw);
        });
        
        // 移动设备触摸事件
        document.addEventListener('touchstart', (e) => {
            e.preventDefault();
            
            // 检查是否触摸到时钟区域
            const touch = e.touches[0];
            const targetElement = document.elementFromPoint(touch.clientX, touch.clientY);
            
            if (targetElement.closest('.clock-container')) {
                // 触摸到时钟区域，触发增强烟花循环
                startEnhancedFireworksCycle();
            } else {
                // 触摸其他区域，发射单个烟花
                const fw = new Firework(touch.clientX);
                fireworks.push(fw);
            }
        }, { passive: false });
    </script>
</body>
</html>